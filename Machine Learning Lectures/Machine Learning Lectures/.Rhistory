library(caret)
library(AppliedPredictiveModeling)
set.seed(3433)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
head(predictors)
IL
predictors$IL
predictors
head(predictors)
head(predictors[3,20:30])
head(predictors[3,40:5])
head(predictors[3,40:55])
head(predictors[3,57:70])
head(predictors[3,53:70])
head(predictors[3,50:70])
head(predictors[3,50:70])
head(predictors[3,53:70])
head(predictors[3,56:70])
head(predictors[3,57:69])
head(predictors[3,57:67])
head(predictors[,57:67])
head(predictors[,57:68])
head(predictors[,57:69])
head(predictors[,57:68])
head(predictors[,56:68])
head(predictors[,57:68])
IL <- predictors[,57:68]
training adData[inTrain,]
training
IL <- training[,57:68]
preProcess
?preProcess
ILtrain <- training[,57:68]
ILtest <- testing[,57:68]
preProc <- preProcess(log10(ILtrain))
preProc <- preProcess(log10(ILtrain), method="pca", pcaComp=2)
head(ILtrain)
preProc <- preProcess(log10(ILtrain), method="pca", pcaComp=2)
ILtest <- testing[,58:68]
ILtrain <- training[,58:68]
head(ILtrain)
head(train)
head(training)
ILtrain <- training[,58:69]
head(ILtrain)
ILtest <- testing[,58:69]
preProc <- preProcess(log10(ILtrain), method="pca", pcaComp=2)
preProc <- preProcess(log10(ILtrain + 1), method="pca", pcaComp=2)
preProc <- preProcess(log10(ILtrain +1), method="pca", pcaComp=2)
log10(ILtrain +1)
preProc <- preProcess(ILtrain, method="pca", pcaComp=2)
modelFit <- train(diagnosis ~ .,method="glm",preProcess="pca",data=ILfit)
# print results of model
confusionMatrix(diagnosis,predict(modelFit,testing)
)
modelFit <- train(diagnosis ~ .,method="glm",preProcess="pca",data=ILtrain)
# print results of model
confusionMatrix(diagnosis,predict(modelFit,testing)
preProc
preProc
preProc <- preProcess(ILtrain, method="pca", thresh=80)
preProc
preProc <- preProcess(ILtrain, method="pca", thresh=0.8)
preProc
library(caret)
library(AppliedPredictiveModeling)
set.seed(3433)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
preProc <- preProcess(ILtrain, method="pca", thresh=0.8)
trainPC <- predict(preProc,training)
preProc <- preProcess(ILtrain, method="pca", thresh=0.8)
trainPC <- predict(preProc,training)
prePrc
prePrcc
preProc
trainPC <- predict(preProc,training)
trainPC <- predict(preProc,ILtrain)
modelFit <- train(training$type ~ .,method="glm",data=trainPC)
modelFit <- train(training ~ .,method="glm",data=trainPC)
head(trainPC)
modelFit <- train(diagnosis ~ .,method="glm",data=trainPC)
modelFit <- train(training ~ .,method="glm",data=trainPC)
?train
modelFit <- train(training ~ .,method="glm",data=trainPC)
head(trainPC)
trainPC <- predict(preProc,training)
modelFit <- train(training ~ .,method="glm",data=trainPC)
modelFit <- train(diagnosis ~ .,method="glm",data=trainPC)
dim(diagnosis)
diagnosis
head(training)
modelFit <- train(training$diagnosis ~ .,method="glm",data=trainPC)
install.packages("e1071")
modelFit <- train(training$diagnosis ~ .,method="glm",data=trainPC)
testPC <- predict(preProc,testing)
testPC <- predict(preProc,ilTest)
testPC <- predict(preProc,ILTest)
testPC <- predict(preProc,ILtest)
confusionMatrix(testing$type,predict(modelFit,testPC))
confusionMatrix(testing$diagnosis,predict(modelFit,testPC))
swirl()
library(swirl)
swirl()
bye
bye()
library(tree)
install.packages("tree")
> library(ISLR)
> attach(Carseats )
> High=ifelse(Sales <=8,"No","Yes ")
library(ISLR)
attach(Carseats )
High=ifelse(Sales <=8,"No","Yes ")
library(ISLR)
attach(Carseats)
High=ifelse(Sales <=8,"No","Yes ")
library(ISLR)
attach(Carseats)
High=ifelse(Carseats$Sales <=8,"No","Yes")
Carseats
library(Carseats)
data(Carseats)
library(ISLR)
install.packages("ISLR")
library(ISLR)
attach(Carseats)
High=ifelse(Carseats$Sales <=8,"No","Yes")
Carseats =data.frame(Carseats, High)
tree.carseats =tree(High~,-Sales, Carseats)
tree.carseats <- tree(High~,-Sales, Carseats)
tree.carseats <- tree(High~.-Sales, Carseats)
library(tree)
tree.carseats <- tree(High~.-Sales, Carseats)
summary(tree.carseats)
plot(tree.carseats )text(tree.carseats ,pretty =0)
plot(tree.carseats)
text(tree.carseats, pretty =0)
plot(tree.carseats)
plot(tree.carseats)
text(tree.carseats, pretty =0)
library(AppliedPredictiveModeling)
library(caret)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
trainIndex = createDataPartition(diagnosis, p = 0.50,list=FALSE)
training = adData[trainIndex,]
testing = adData[-trainIndex,]
adData = data.frame(diagnosis,predictors)
trainIndex = createDataPartition(diagnosis,p=0.5,list=FALSE)
training = adData[trainIndex,]
testing = adData[trainIndex,]
library(AppliedPredictiveModeling)
data(concrete)
library(caret)
set.seed(1000)
inTrain = createDataPartition(mixtures$CompressiveStrength, p = 3/4)[[1]]
training = mixtures[ inTrain,]
testing = mixtures[-inTrain,]
hist(mixtures$SuperPlasticizer)
mixtures$SuperPlasticizer
head(mixtures)
hist(mixtures$Superplasticizer)
summary(mixtures$Superplasticizer)
library(caret)
library(AppliedPredictiveModeling)
set.seed(3433)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
preProc <- preProcess(ILtrain, method="pca", thresh=0.8)
preProc
ILtrain <- training[,58:69]
trainPC <- predict(preProc,training)
testPC <- predict(preProc,ILtest)
confusionMatrix(testing$diagnosis,predict(modelFit,testPC))
preProcNorm <- preProcess(ILtrain, method="glm", thresh=0.8)
preProcNorm <- preProcess(ILtrain, thresh=0.8)
testPC1 <- predict(preProcNorm,ILtest)
confusionMatrix(testing$diagnosis,predict(modelFit,testPC1))
preProc <- preProcess(ILtrain, method="pca", thresh=0.8)
preProc
head(ILtrain)
head(training)
head(training$IL)
head(training$IL*)
training[ , grepl( "IL" , names( training ) ) ]
head(training[ , grepl( "IL" , names( training ) ) ])
preProc <- preProcess(ILtrain, method="pca", thresh=0.8)
prePrc
preProc
preProc <- preProcess(ILtrain, method="pca", thresh=0.9)
preProc
library(AppliedPredictiveModeling)
data(segmentationOriginal)
library(caret)
set.seed(125)
inTrain = createDataPartition(segmentationOriginal$Case, p = 0.6)[[1]]
train.1 = segmentationOriginal[inTrain,]
test.1 = segmentationOriginal[-inTrain,]
?rpart
tr <- train(Case ~ ., method = "rpart", data = train.1)
tr$finalModel
plot(tr)
plot(tr$finalModel)
text(tr$finalModel, pretty =0)
text(tr$finalModel)
plot(tr$finalModel)
segpred<- data.frame(TotalIntench2 = 23,000; FiberWidthCh1 = 10; PerimStatusCh1=2)
segpred<- data.frame(TotalIntench2 = 23,000, FiberWidthCh1 = 10, PerimStatusCh1=2)
segpred
segpred <- cbind(segpred, data.frame(TotalIntench2 = 50,000, FiberWidthCh1 = 10, VarIntenCh4 = 100))
segpred <- cbind(segpred, data.frame(TotalIntench2 = 57,000, FiberWidthCh1 = 8, VarIntenCh4 = 100))
segpred <- cbind(segpred, data.frame(FiberWidthCh1 = 8, VarIntenCh4 = 100, PerimStatusCh1=2))
segpred
segpred<- data.frame(TotalIntench2 = 23,000, FiberWidthCh1 = 10, PerimStatusCh1=2)
segpred
segpred <- rbind(segpred, data.frame(TotalIntench2 = 50,000, FiberWidthCh1 = 10, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = 57,000, FiberWidthCh1 = 8, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(FiberWidthCh1 = 8, VarIntenCh4 = 100, PerimStatusCh1=2))
segpred<- data.frame(TotalIntench2 = 23,000, FiberWidthCh1 = 10, PerimStatusCh1=2, VarIntenCh4 = NA)
segpred <- rbind(segpred, data.frame(TotalIntench2 = 50,000, FiberWidthCh1 = 10, PerimStatusCh1=NA, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = 57,000, FiberWidthCh1 = 8, PerimStatusCh1=NA, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = NA, FiberWidthCh1 = 8, VarIntenCh4 = 100, PerimStatusCh1=2))
segpred<- data.frame(TotalIntench2 = 23,000, FiberWidthCh1 = 10, PerimStatusCh1=2, VarIntenCh4 = NA)
segpred
segpred <- rbind(segpred, data.frame(TotalIntench2 = 50,000, FiberWidthCh1 = 10, PerimStatusCh1=NA, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = 57,000, FiberWidthCh1 = 8, PerimStatusCh1=NA, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = NA, FiberWidthCh1 = 8, VarIntenCh4 = 100, PerimStatusCh1=2))
segpred<- data.frame(TotalIntench2 = 23,000, FiberWidthCh1 = 10, PerimStatusCh1=2, VarIntenCh4 = NA)
segpred <- rbind(segpred, data.frame(TotalIntench2 = 50,000, FiberWidthCh1 = 10, PerimStatusCh1=NA, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = 57,000, FiberWidthCh1 = 8, PerimStatusCh1=NA, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = NA, FiberWidthCh1 = 8, VarIntenCh4 = 100, PerimStatusCh1=2))
segpred<- data.frame(TotalIntench2 = 23,000, FiberWidthCh1 = 10, PerimStatusCh1=2, VarIntenCh4 = NA)
segpred <- rbind(segpred, data.frame(TotalIntench2 = 50,000, FiberWidthCh1 = 10, PerimStatusCh1=NA, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = 57,000, FiberWidthCh1 = 8, PerimStatusCh1=NA, VarIntenCh4 = 100))
segpred <- rbind(segpred, data.frame(TotalIntench2 = NA, FiberWidthCh1 = 8, PerimStatusCh1=2, VarIntenCh4 = 100))
segpred
segpred <- rbind(segpred, data.frame(TotalIntench2 = NA, x0=0, FiberWidthCh1 = 8, VarIntenCh4 = 100, PerimStatusCh1=2))
segpred <- rbind(segpred, c(TotalIntench2 = NA, x0=0, FiberWidthCh1 = 8, VarIntenCh4 = 100, PerimStatusCh1=2))
segpred
segpred[,-2]
segpred <- segpred[,-2]
segpred
a <- predict(tr,segpred)
head(segmentationOriginal)
head(segmentationOriginal)$Case
View(segmentationOriginal)
createDataPartition(y=segmentationOriginal$Case, times=1, p=0.75, list=FALSE)
inTrain <- createDataPartition(y=segmentationOriginal$Case, times=1, p=0.75, list=FALSE)
set.seed(125)
train.1 = segmentationOriginal[inTrain,]
test.1 = segmentationOriginal[-inTrain,]
segmentationOriginal$CART
tr <- train(Class ~ ., method = "rpart", data = train.1)
head(getTree(tr$finalModel)
)
tr$finalModel
plot(tr)
plot(tr$finalModel)
text(tr$finalModel)
tr$finalModel$prox
rattle::fancyRpartPlot(tr$finalModel)
install.packages("rattle")
library(rattle)
rattle::fancyRpartPlot(tr$finalModel)
